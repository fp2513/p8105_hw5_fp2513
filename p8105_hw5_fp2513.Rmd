---
title: "p8105_hw5_fp2513"
output: github_document
date: "2024-11-07"
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(rvest)
```


## Problem 1

Suppose you put ð‘›people in a room, and want to know the probability that at least two people share a birthday. For simplicity, weâ€™ll assume there are no leap years (i.e. there are only 365 days) and that birthdays are uniformly distributed over the year (which is actually not the case).

Write a function that, for a fixed group size, randomly draws â€œbirthdaysâ€ for each person; checks whether there are duplicate birthdays in the group; and returns TRUE or FALSE based on the result.


```{r}
birthday = sample(1:365, 10, replace = TRUE) %>% print()

if (any(duplicated(birthday))) {
  cat("TRUE")
} else {
  cat("FALSE")
}
```

```{r}
check_duplicate_birthdays = function(n) {  
  
  birthdays = sample(1:365, n, replace = TRUE)
 
    has_duplicates = any(duplicated(birthdays))

    return(has_duplicates)
   
}

n = 10
result = check_duplicate_birthdays(n)
cat("Do at least two people share a birthday?", result, n)

```

Next, run this function 10000 times for each group size between 2 and 50. For each group size, compute the probability that at least two people in the group will share a birthday by averaging across the 10000 simulation runs. Make a plot showing the probability as a function of group size, and comment on your results.


```{r}
n_list = 2:50

output = vector("list", length = length(n_list))

for (i in seq_along(n_list)) {
  
  output[[i]] <- rerun(10000, check_duplicate_birthdays(n = n_list[i])) %>%
    unlist() %>%
    as.data.frame() %>%
    setNames(paste0("group_size_", n_list[i]))
}

result_df <- bind_cols(output)
head(result_df)
```


