p8105_hw5_fp2513
================
2024-11-07

## Problem 1

Suppose you put ð‘›people in a room, and want to know the probability that
at least two people share a birthday. For simplicity, weâ€™ll assume there
are no leap years (i.e.Â there are only 365 days) and that birthdays are
uniformly distributed over the year (which is actually not the case).

Write a function that, for a fixed group size, randomly draws
â€œbirthdaysâ€ for each person; checks whether there are duplicate
birthdays in the group; and returns TRUE or FALSE based on the result.

``` r
birthday = sample(1:365, 10, replace = TRUE) %>% print()
```

    ##  [1] 122 321 118 243 335 353 286  89 248  67

``` r
if (any(duplicated(birthday))) {
  cat("TRUE")
} else {
  cat("FALSE")
}
```

    ## FALSE

``` r
check_duplicate_birthdays = function(n) {  
  
  birthdays = sample(1:365, n, replace = TRUE)
 
    has_duplicates = any(duplicated(birthdays))

    return(has_duplicates)
   
}

n = 10
result = check_duplicate_birthdays(n)
cat("Do at least two people share a birthday?", result, n)
```

    ## Do at least two people share a birthday? FALSE 10

Next, run this function 10000 times for each group size between 2 and
50. For each group size, compute the probability that at least two
people in the group will share a birthday by averaging across the 10000
simulation runs. Make a plot showing the probability as a function of
group size, and comment on your results.

``` r
n_list = 2:50

output = vector("list", length = length(n_list))

for (i in seq_along(n_list)) {
  
  output[[i]] <- rerun(10000, check_duplicate_birthdays(n = n_list[i])) %>%
    unlist() %>%
    as.data.frame() %>%
    setNames(paste0("group_size_", n_list[i]))
}
```

    ## Warning: `rerun()` was deprecated in purrr 1.0.0.
    ## â„¹ Please use `map()` instead.
    ##   # Previously
    ##   rerun(10000, check_duplicate_birthdays(n = n_list[i]))
    ## 
    ##   # Now
    ##   map(1:10000, ~ check_duplicate_birthdays(n = n_list[i]))
    ## This warning is displayed once every 8 hours.
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

``` r
result_df <- bind_cols(output)
head(result_df)
```

    ##   group_size_2 group_size_3 group_size_4 group_size_5 group_size_6 group_size_7
    ## 1        FALSE        FALSE        FALSE        FALSE        FALSE        FALSE
    ## 2        FALSE        FALSE        FALSE        FALSE        FALSE        FALSE
    ## 3        FALSE        FALSE        FALSE        FALSE        FALSE        FALSE
    ## 4        FALSE        FALSE        FALSE        FALSE        FALSE        FALSE
    ## 5        FALSE        FALSE        FALSE        FALSE        FALSE         TRUE
    ## 6        FALSE        FALSE        FALSE        FALSE        FALSE        FALSE
    ##   group_size_8 group_size_9 group_size_10 group_size_11 group_size_12
    ## 1        FALSE        FALSE         FALSE         FALSE         FALSE
    ## 2        FALSE        FALSE         FALSE         FALSE          TRUE
    ## 3        FALSE        FALSE          TRUE         FALSE         FALSE
    ## 4         TRUE         TRUE         FALSE          TRUE         FALSE
    ## 5        FALSE        FALSE         FALSE         FALSE         FALSE
    ## 6        FALSE        FALSE         FALSE         FALSE          TRUE
    ##   group_size_13 group_size_14 group_size_15 group_size_16 group_size_17
    ## 1         FALSE          TRUE         FALSE         FALSE          TRUE
    ## 2         FALSE         FALSE          TRUE         FALSE         FALSE
    ## 3         FALSE         FALSE         FALSE         FALSE         FALSE
    ## 4         FALSE         FALSE         FALSE          TRUE         FALSE
    ## 5         FALSE         FALSE         FALSE         FALSE         FALSE
    ## 6         FALSE         FALSE          TRUE         FALSE          TRUE
    ##   group_size_18 group_size_19 group_size_20 group_size_21 group_size_22
    ## 1          TRUE         FALSE          TRUE         FALSE          TRUE
    ## 2         FALSE          TRUE          TRUE         FALSE          TRUE
    ## 3          TRUE         FALSE          TRUE         FALSE         FALSE
    ## 4          TRUE         FALSE         FALSE          TRUE         FALSE
    ## 5          TRUE         FALSE         FALSE         FALSE          TRUE
    ## 6          TRUE         FALSE          TRUE         FALSE         FALSE
    ##   group_size_23 group_size_24 group_size_25 group_size_26 group_size_27
    ## 1         FALSE          TRUE         FALSE          TRUE          TRUE
    ## 2         FALSE         FALSE         FALSE          TRUE          TRUE
    ## 3          TRUE          TRUE          TRUE          TRUE         FALSE
    ## 4          TRUE         FALSE          TRUE          TRUE          TRUE
    ## 5          TRUE         FALSE         FALSE          TRUE          TRUE
    ## 6         FALSE         FALSE         FALSE          TRUE          TRUE
    ##   group_size_28 group_size_29 group_size_30 group_size_31 group_size_32
    ## 1          TRUE         FALSE          TRUE          TRUE          TRUE
    ## 2         FALSE          TRUE          TRUE         FALSE          TRUE
    ## 3          TRUE          TRUE          TRUE         FALSE          TRUE
    ## 4          TRUE          TRUE         FALSE          TRUE         FALSE
    ## 5         FALSE          TRUE          TRUE          TRUE          TRUE
    ## 6         FALSE          TRUE         FALSE          TRUE         FALSE
    ##   group_size_33 group_size_34 group_size_35 group_size_36 group_size_37
    ## 1         FALSE          TRUE          TRUE         FALSE          TRUE
    ## 2         FALSE          TRUE          TRUE          TRUE         FALSE
    ## 3         FALSE         FALSE          TRUE          TRUE          TRUE
    ## 4          TRUE         FALSE          TRUE          TRUE          TRUE
    ## 5          TRUE          TRUE          TRUE          TRUE         FALSE
    ## 6          TRUE          TRUE          TRUE          TRUE          TRUE
    ##   group_size_38 group_size_39 group_size_40 group_size_41 group_size_42
    ## 1          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 2          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 3          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 4          TRUE          TRUE          TRUE         FALSE          TRUE
    ## 5         FALSE          TRUE          TRUE          TRUE          TRUE
    ## 6          TRUE         FALSE          TRUE          TRUE          TRUE
    ##   group_size_43 group_size_44 group_size_45 group_size_46 group_size_47
    ## 1          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 2          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 3          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 4          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 5          TRUE          TRUE          TRUE          TRUE          TRUE
    ## 6         FALSE          TRUE          TRUE          TRUE          TRUE
    ##   group_size_48 group_size_49 group_size_50
    ## 1          TRUE          TRUE          TRUE
    ## 2          TRUE          TRUE          TRUE
    ## 3          TRUE          TRUE          TRUE
    ## 4          TRUE          TRUE          TRUE
    ## 5          TRUE          TRUE          TRUE
    ## 6          TRUE          TRUE          TRUE
